<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Metal Gear Solid V guns</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/app.css" />
    <style type="text/css">
    tbody tr td {
      border-top-width: 1px;
      border-bottom-width: 1px;
      border-left-width: 1px;
      border-right-width: 1px;
      border-color: #000000
    }
    </style>
  </head>
  <body>

    <div class="row">
      <div class="large-12 columns">
        <h3><center>MGSV weapons table</center></h3>
      </div>
    </div>

    <div class='row' style='max-width: 100em'>
      <div class="large-12 columns">
        <h4>Contents</h4>

        <ul>
          <li><a href='#notes'>Notes</a></li>
          <li><a href='#t3'>All parts</a></li>
          <li><a href='#t2'>Open slots</a></li>
          <li><a href='#t1'>Default gun parts</a></li>
        </ul>
      </div>
    </div>


    <div class='row' style='max-width: 100em'>
      <div class="large-12 columns">
       These tables contain vital information about MGSV guns. Please read README for basic info here - <a href="https://github.com/unknown321/mgsmonsterguns">https://github.com/unknown321/mgsmonsterguns</a>. 
       <br>
       Most of info was ripped from <span class="secondary label">\master\0\00\Assets\tpp\level_asset\weapon\ParameterTables\parts\EquipParameters.lua</span> and <span class="secondary label">\master\0\00\Assets\tpp\motherbase\script\WeaponPartsCombinationSettings.lua</span> using <a href='https://www.dropbox.com/s/0rtpumx2mxsjaby/MGSV_QAR_Tool.rar?dl=0'>MGSV QAR Tool v1.3 by Sergeanur</a>, <a href='https://github.com/Atvaark/FoxEngine.TranslationTool'>FoxEngine.TranslationTool</a> and some Python magic.
       <br>
       All parts table is sorted by part type and used when you need it.
       <br>
       Open slots table is sorted by type (frame->barrel) and amount of slots (from less to more). You should use it when you need to find a frame with many slots for example.
       <br>
       Default gun parts table has all parts for every single default gun. Not sure when you'll need to use this, nonetheless it is here.
       <br>
       All data is parsed from json files from <a href="https://github.com/unknown321/mgsmonsterguns/tree/gh-pages/js">/js/</a> directory.
       <br>
       <br>
       <h4>How to identify your gun (using SERVAL grade 7 as example)</h4>
       <ul>
         <li>Load guns in Development flow table below</li>
         <li>Ctrl+F <span class="secondary label">SERVAL AMR-7, ★8</span></li>
         <li>Look for <span class="secondary label">"weapon":"TppEquip.WP_60417"</span></li>
         <li>Open <span class="secondary label">EquipParameters.lua</span> (for closed slots) / <span class="secondary label">WeaponPartsCombinationSettings.lua</span> (open slots)</li>
         <li>Ctrl+F - <span class="secondary label">TppEquip.WP_60417</span> </li>
         <li>You did it.</li>
         <li><img src='img/serval.png' width="30%"></li>
       </ul>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <table id='t3' class='stack hover'>
         <caption>All parts <a href="#!" onClick='load_parts()'>load</a></caption>
          <thead>
            <td>Type</td>
            <td>Name</td>
            <td>partsID</td>
            <td>Description</td>
          </thead>
          <tbody id='parts'>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <table id='t2' class='stack hover'>
         <caption>Open slots on barrels and frames <a href="#!" onClick='load_slots()'>load</a></caption>
          <thead>
            <td>partsID</td>
            <td>Name</td>
            <td>Slots</td>
          </thead>
          <tbody id='open_slots'>
          </tbody>
        </table>
      </div>
    </div>


    <div class="row">
      <div class="large-12 columns">
        <table id='t1' class='stack hover'>
         <caption>Default gun parts <a href="#!" onClick='load_default()'>load</a></caption>
          <thead>
            <td>Frame</td>
            <td>Barrel</td>
            <td>Magazine</td>
            <td>Stock</td>
            <td>Muzzle</td>
            <td>Muzzle option</td>
            <td>Flashlight</td>
            <td>Sight</td>
            <td>Laser sight</td>
            <td>Foregrip</td>
          </thead>
          <tbody id='default_gun_parts'>
          </tbody>
        </table>
      </div>
    </div>


    <div class="row">
      <div class="large-12 columns">
        <table id='t4' class='stack hover'>
         <caption>Development flow <a href="#!" onClick='load_devflow()'>load</a></caption>
          <thead>
          <td>Section 1</td>
          <td>Section 2</td>
          <td>Section 3</td>
          <td>Section 4</td>
          <td>Section 5</td>
          <td>Section 6</td>
          <td>Section 7</td>
          </thead>
          <tbody id='devflow'>
  
          </tbody>
        </table>
      </div>
    </div>

<!-- <div class='row' id="devflow"></div> -->

    <script src="js/vendor/jquery.min.js"></script>
    <script src="js/vendor/what-input.min.js"></script>
    <script src="js/foundation.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/jquery.lazyload.js"></script>
    <script src="js/jquery.floatThead.min.js"></script>
    <script type="text/javascript">
      function load_parts(){
        //javascript is gross
        $.getJSON('js/parts.json').done(function (data){
          $.each(data, function (i,f)
          {
            var desc = ""
            f.abilities.forEach(function(s){
              desc = desc + s + ', '
            })
            desc = desc.slice(0,-2)
            $('#parts').append("\
              <tr>\
                <td>" + f.type + "</td><td>" + f.name + "</td><td>" + f.partID + 
                "</td><td>" + desc + "</td>\
              </tr>")
          })
          table3 = $('[id=t3]');
          table3.floatThead();
        })
      }


      function load_slots(){
        $.getJSON('js/open_slots.json').done(function (data){
          $.each(data, function (i,f)
          {
            $('#open_slots').append("\
              <tr>\
                <td>" + f.receiver + "</td><td>" + f.names.part + "</td><td>" + f.names.slots +"</td>\
              </tr>")
          })
          table2 = $('[id=t2]');
          table2.floatThead();
        })
      }



      function load_default(){
        $.getJSON('js/default_gun_components.json').done(function (data){
          keys = ["frame","barrel","magazine","stock","muzzle","muzzle_option","flashlight","sight","laser_sight","foregrip"]
          $.each(data, function (i,f)
          {
            keys.forEach(function(key) {
              
              if (!(f['names'].hasOwnProperty(key))) {
                  f['names'][key] = ""
              }
            })

            $('#default_gun_parts').append("\
              <tr>\
                <td>" + f.names.frame + "</td><td>" + f.names.barrel + "</td><td>" + f.names.magazine + 
                "</td><td>" + f.names.stock + "</td><td>" + f.names.muzzle + "</td><td>" + f.names.muzzle_option + 
                "</td><td>" + f.names.flashlight + "</td><td>" + f.names.sight + "</td><td>" + f.names.laser_sight + "</td><td>" + f.names.foregrip + "</td>\
              </tr>")
          })
          table1 = $('[id=t1]');
          table1.floatThead();
        })
      }



      function load_devflow(){
        //very inefficent
        $.getJSON('js/relations.json').done(function (data){
          $.each(data, function (i,f)
          {
            fakerow = "<tr><td>--------------</td></tr>"
            $('#devflow').append(fakerow)
            row = "<tr id='" + f.item_id + "_" + f.grade + "'>\
                    <td>"
            if (f.item_id > 0)
              row = row + "<a onClick=show_info(this," + f.item_id + ")>▼</a>"
            row = row + f.name + ', ★' + f.grade + 
                     "</td>\
                  </tr>"

            $('#devflow').append(row)
            if ('children' in f)
              parse_children(f,1)
          })
          table4 = $('[id=t4]');
          table4.floatThead();
        })
      }

      function parse_children(parent, depth){
          parent['children'].forEach(function (item){
            row = '<tr>'
            amount = 1
            while (amount != depth){
              row = row + '<td></td>'
              amount = amount + 1
            }
            row = row + '<td style="text-align:right">└─────&gt;</td>'
            row = row + "<td><a onClick=show_info(this," + item.item_id + ")>▼</a>" + item.name + ', ★' + item.grade + "</td>"
            row = row + "</tr>"
            $('#devflow').append(row)
            
            if ('children' in item)
              parse_children(item, depth+1)
          })
      }

    function show_info(cell,item_id) {
     $.getJSON('js/default_gun_components.json').done(
      function (data){
         item = $(data).filter(
         function (i,n){
           return n['item_id']==item_id
         })
     console.log(item)
     item = item[0]
     console.log(item.icon.lastIndexOf('/'))
     icon = item.icon.substr(item.icon.lastIndexOf('/'))
     type = item.type.replace('TppMbDev.','')
     moretext = "<a onClick='hide_info(this," +"\""  + item.names.name + ", ★" + item.parts.grade +"\"," + item.item_id + ")'>▶</a>" + 
                item.names.name + ', ★' + item.parts.grade + 
                "<br><img style='background-color:#3d6c81;' src='img/weapons/" + icon + ".png'>" + 
                "<br>name: " + item.names.name + 
                "<br>grade: " + item.names.grade + 
                "<br>weapon: " + item.names.weapon + 
                "<br>item id: " + item.item_id + 
                "<br>parent id: " + item.parent_id + 
                "<br>type: " + type + 
                "<br>item id: " + item.item_id + 
                "<br>Parts: <textarea cols='40' rows='1'>" + JSON.stringify(item.parts) + "</textarea>" + 
                "<br>Part names: <textarea cols='40' rows='1'>" + JSON.stringify(item.names) + "</textarea>"
                
              
     $(cell).parent().html(moretext)
     table4 = $('[id=t4]');
     table4.floatThead();
  })



    }
function hide_info(cell,text,item_id){
  text = "<a onClick=show_info(this," + item_id + ")>▼</a>" + text
  $(cell).parent().html(text)
}
    function clear(){
      $('tbody > tr').remove()
    }
          


        </script>
      </body>


</html>
